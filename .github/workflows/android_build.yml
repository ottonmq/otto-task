name: üö® FORJA-OTTO-DEFENSA-TOTAL üö®
on: [push, workflow_dispatch]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: üõ∞Ô∏è Sincronizando
        uses: actions/checkout@v4

      - name: üõ†Ô∏è Instalando Android SDK Manualmente
        run: |
          sudo apt update
          sudo apt install -y openjdk-17-jdk wget unzip
          # Bajamos las herramientas b√°sicas para que NO diga "command not found"
          mkdir -p cmdline-tools
          wget https://dl.google.com/android/repository/commandlinetools-linux-9477386_latest.zip
          unzip commandlinetools-linux-9477386_latest.zip -d cmdline-tools
          mv cmdline-tools/cmdline-tools cmdline-tools/latest
          # Configuramos la ruta (el mapa para el robot)
          echo "ANDROID_HOME=$HOME/android-sdk" >> $GITHUB_ENV
          echo "$HOME/android-sdk/cmdline-tools/latest/bin" >> $GITHUB_PATH

      - name: üñãÔ∏è Licencias y Aidl (Ruta Forzada)
        run: |
          yes | sdkmanager --licenses --sdk_root=$ANDROID_HOME || true
          sdkmanager "platforms;android-34" "build-tools;34.0.0" --sdk_root=$ANDROID_HOME

      - name: ü§ñ Fabricando APK con Buildozer
        run: |
          pip3 install --upgrade buildozer Cython==0.29.33 virtualenv
          buildozer android debug
          
