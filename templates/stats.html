{% extends "base.html" %}

{% block content %}
<div class="container py-4">
    <div class="d-flex align-items-center mb-5" style="border-left: 4px solid #00f2ff; padding-left: 20px;">
        <div>
            <h2 class="text-white mb-0" style="letter-spacing: 3px; font-weight: 800;">GLOBAL_MARKET_STATS</h2>
            <div class="d-flex align-items-center">
                <div class="status-dot-blink me-2" style="width: 8px; height: 8px; background: #00f2ff; border-radius: 50%; box-shadow: 0 0 10px #00f2ff;"></div>
                <small style="color: #00f2ff; font-family: monospace;">ESCANEANDO_BASE_DE_DATOS_CENTRAL...</small>
            </div>
        </div>
    </div>

    <div class="row g-4 mb-5">
        <div class="col-md-4">
            <div class="stats-card-cyber">
                <small class="text-muted">TOTAL_UNIDADES_ACTIVAS</small>
                <div class="d-flex align-items-baseline">
                    <h2 class="display-5 fw-bold text-white mb-0">842</h2>
                    <span class="ms-2 text-info" style="font-size: 12px;">+14% HOY</span>
                </div>
                <div class="scan-line-mini"></div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="stats-card-cyber border-accent">
                <small class="text-muted">OPERADORES_EN_LÍNEA</small>
                <h2 class="display-5 fw-bold text-white mb-0">158</h2>
                <div class="progress mt-2" style="height: 4px; background: #111;">
                    <div class="progress-bar bg-info" style="width: 65%;"></div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="stats-card-cyber">
                <small class="text-muted">VOLUMEN_TRANSACCIONES</small>
                <h2 class="display-5 fw-bold text-white mb-0">$1.2M</h2>
                <small class="text-success" style="font-size: 11px;">ESTATUS: ALTA_DEMANDA</small>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="main-chart-container p-4">
                <h6 class="text-white mb-4"><i class="bi bi-graph-up me-2"></i> FLUJO_DE_VENTAS_7D (GLOBAL)</h6>
                <canvas id="globalMarketChart" style="height: 300px;"></canvas>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="side-panel-cyber p-4">
                <h6 class="text-info mb-3">TOP_CATEGORÍAS</h6>
                <ul class="list-unstyled">
                    <li class="d-flex justify-content-between mb-3 border-bottom border-dark pb-2">
                        <span class="text-muted">VEHÍCULOS</span>
                        <span class="text-white fw-bold">45%</span>
                    </li>
                    <li class="d-flex justify-content-between mb-3 border-bottom border-dark pb-2">
                        <span class="text-muted">INMUEBLES</span>
                        <span class="text-white fw-bold">32%</span>
                    </li>
                    <li class="d-flex justify-content-between mb-3 border-bottom border-dark pb-2">
                        <span class="text-muted">TECNOLOGÍA</span>
                        <span class="text-white fw-bold">23%</span>
                    </li>
                </ul>
                <div class="alert alert-info bg-dark border-info mt-4" style="font-size: 11px; color: #00f2ff;">
                    <i class="bi bi-info-circle me-1"></i> NOTA: Los datos se actualizan cada ciclo de sincronización de red (60s).
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .stats-card-cyber {
        background: #0a0a0a;
        border: 1px solid #1a1a1a;
        padding: 25px;
        border-radius: 4px;
        position: relative;
        overflow: hidden;
    }
    .stats-card-cyber.border-accent { border-top: 3px solid #00f2ff; }
    .main-chart-container { background: #0a0a0a; border: 1px solid #1a1a1a; border-radius: 4px; }
    .side-panel-cyber { background: #050505; border: 1px solid #1a1a1a; height: 100%; }
    
    @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
    .status-dot-blink { animation: blink 1.5s infinite; }
    
    .scan-line-mini {
        position: absolute;
        bottom: 0; left: 0; width: 100%; height: 2px;
        background: linear-gradient(90deg, transparent, #00f2ff, transparent);
        animation: scan 3s linear infinite;
    }
    @keyframes scan { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctxGlobal = document.getElementById('globalMarketChart').getContext('2d');
    new Chart(ctxGlobal, {
        type: 'bar',
        data: {
            labels: ['LUN', 'MAR', 'MIE', 'JUE', 'VIE', 'SAB', 'DOM'],
            datasets: [{
                label: 'PUBLICACIONES_NUEVAS',
                data: [45, 62, 55, 80, 120, 150, 95],
                backgroundColor: 'rgba(0, 242, 255, 0.6)',
                borderColor: '#00f2ff',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: { grid: { color: '#1a1a1a' }, ticks: { color: '#666' } },
                x: { grid: { display: false }, ticks: { color: '#666' } }
            },
            plugins: { legend: { display: false } }
        }
    });
</script>
{% endblock %}
